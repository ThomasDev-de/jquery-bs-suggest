!function(t){let e={limit:10,typingInterval:400,darkMenu:!1,btnWidth:"fit-content",btnClass:"btn btn-outline-secondary",searchPlaceholderText:"Search",emptyText:"Please choose..",waitingForTypingText:"Waiting for typing",typingText:"typing..",loadingText:"Loading.."};function n(t){return t.closest('[id^="webcito_suggestion_"]')}function i(t){a(t,!1),t.suggest(t.data("settings")||{})}function a(t,e){let i=t.val(),a=n(t);t.insertBefore(a),a.remove(),t.val(i),t.data("init",!1),e&&t.show()}function s(t,e){let i=e.data("settings");n(e).find(".js-selected-text").html(t||i.emptyText)}t.fn.suggest=function(l,o){return t(this).each(function(){let d=t(this),r=null,c;("object"==typeof l||void 0===l)&&d.data("settings",t.extend(!0,e,l||{}));let g=function e(i){var a;let l=n(i);if(l.length)return l;let o="webcito_suggestion_"+t('[id^="webcito_suggestion_"]').length,d=t("<div>",{id:o}).insertAfter(i);i.hide(),i.appendTo(d);let r,c;return t(`            <div class="dropdown">                  <button type="button" class=" d-flex align-items-center justify-content-between ${r.btnClass} dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" style="width:${r.btnWidth}">                    <span class="js-selected-text"></span>                  </button>                  <div class="dropdown-menu ${c=(r=(a=i).data("settings")).darkMenu?"dropdown-menu-dark":""} p-0 mt-1">                    <div class="card bg-transparent border-0 m-0 w-100">                        <div class="card-header d-flex flex-nowrap align-items-center justify-content-between">                            <input autocomplete="false" type="search" class="form-control-sm flex-fill" placeholder="${r.searchPlaceholderText}">                            <button role="button" class=" btn-close ${r.darkMenu?"btn-close-white":""} ms-2 js-webcito-reset"></button>                        </div>                         <div class="card-body p-0">                        </div>                        <div class="card-footer bg-secondary text-bg-secondary p-1 fw-light fst-italic d-flex align-items-center">                            <small class="suggest-status-text">${r.waitingForTypingText}</small>                        </div>                    </div>                  </div>            </div>`).insertBefore(i),setTimeout(function(){""===d.find(".js-selected-text").text()&&s(null,i)},40),d}(d),u=g.find(".card-body"),f=g.find(".suggest-status-text"),p=g.find('[type="search"]');function h(t){f.html(t)}function b(){h(d.data("settings").loadingText),m()}function m(e=!0,n){let i=d.data("settings");null!==r&&(r.abort(),r=null);let a=e?{q:p.val()||null,limit:i.limit}:{value:n};r=t.get(d.data("bsTarget"),a,function(n){n.error?d.trigger("error",[n.error]):e?(u.empty(),n.items.forEach(e=>{t("<div>",{html:`<a class="dropdown-item" href="#${e.id}">${e.text}</a>`}).appendTo(u).find("a").data("item",e)}),n.items.length!==n.total?h(`showing ${n.items.length} / ${n.total} results`):h("results: "+n.items.length)):(d.val(n.id),s(n.text,d))})}if(!0!==d.data("init")&&(p.on("keyup",function(){let t=d.data("settings");clearTimeout(c),c=setTimeout(b,t.typingInterval)}),p.on("keydown",function(){let t=d.data("settings");clearTimeout(c),h(t.typingText)}),g.on("click","a.dropdown-item",function(e){e.preventDefault();let n=t(e.currentTarget),i=n.data("item");d.trigger("change",[i.id,i.text]);let a=n.attr("href").substring(1);d.val(a),s(n.html(),d)}).on("click",".js-webcito-reset",function(t){t.preventDefault(),d.val(null),p.val(null),u.empty(),s(null,d);h(d.data("settings").waitingForTypingText)}).on("hidden.bs.dropdown",".dropdown",function(){u.empty(),p.val(null);h(d.data("settings").waitingForTypingText)}).on("shown.bs.dropdown",".dropdown",function(){p.focus()}),d.data("init",!0),""!==d.val()&&m(!1,d.val())),"string"==typeof l)switch(l.toLowerCase()){case"val":let v;v=d.data("settings"),d.val(null),p.val(null),u.empty(),h(v.waitingForTypingText),m(!1,o);break;case"destroy":a(d,!0);break;case"refresh":i(d);break;case"updateoptions":d.data("settings",t.extend(!0,d.data("settings"),o||{},e)),console.log(d.data("settings")),i(d)}return d})}}(jQuery);