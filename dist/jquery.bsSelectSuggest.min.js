!function(t){t.fn.suggest=function(e,n){let i=t(this),o,l=null,a=t.extend(!0,{limit:10,typingInterval:400,darkMenu:!1,btnWidth:"fit-content",btnClass:"btn btn-outline-secondary",searchPlaceholderText:"Search",emptyText:"Please choose..",waitingForTypingText:"Waiting for typing",typingText:"typing..",loadingText:"Loading.."},e&&"object"==typeof e?e:{}),r=function e(){console.log("LOG: build dropdown");let n=i.closest('[id^="webcito_suggestion_"]');if(n.length)return n;let o="webcito_suggestion_"+t('[id^="webcito_suggestion_"]').length,l=t("<div>",{id:o}).insertAfter(i);i.hide(),i.appendTo(l);let r;return t(`<div class=" btn-group dropdown"><button type="button" class=" d-flex align-items-center justify-content-between  ${a.btnClass} dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" style="width:${a.btnWidth}">  <span class="js-selected-text">${a.emptyText}</span></button><div class="dropdown-menu ${r=a.darkMenu?"dropdown-menu-dark":""} p-0 mt-1">  <div class="card bg-transparent border-0 m-0 w-100"><div class="card-header d-flex flex-nowrap align-items-center justify-content-between">    <input autocomplete="false" type="search" name="q" class="form-control-sm flex-fill" placeholder="${a.searchPlaceholderText}">    <button role="button" class=" btn-close ${a.darkMenu?"btn-close-white":""} ms-2 js-webcito-reset"></button></div> <div class="card-body p-0"></div><div class="card-footer bg-secondary text-bg-secondary p-1 fw-light fst-italic d-flex align-items-center">    <small>${a.waitingForTypingText}</small></div>  </div></div></div>`).insertBefore(i),l}(),s=r.find(".card-body"),d=r.find(".card-footer small"),c=r.find('[type="search"]'),g=e&&"string"==typeof e?e:null;function u(t){d.html(t)}function p(){u(a.loadingText),f()}function f(e=!0,n){null!==l&&(l.abort(),l=null);let o=e?{q:c.val()||null,limit:a.limit}:{value:n};l=t.get(i.data("bsTarget"),o,function(n){n.error?i.trigger("suggest-error",[n.error]):e?(s.empty(),n.items.forEach(e=>{t("<div>",{html:`<a class="dropdown-item" href="#${e.id}">${e.text}</a>`}).appendTo(s).find("a").data("item",e)}),n.items.length!==n.total?u(`showing ${n.items.length} / ${n.total} results`):u("results: "+n.items.length)):(i.val(n.id),b(n.text))})}function b(t){r.find(".js-selected-text").html(t||a.emptyText)}return!0!==i.data("init")&&(c.on("keyup",function(){clearTimeout(o),o=setTimeout(p,a.typingInterval)}),c.on("keydown",function(){clearTimeout(o),u(a.typingText)}),r.on("click","a.dropdown-item",function(e){e.preventDefault();let n=t(e.currentTarget),o=n.data();i.trigger("suggest-change",[o.id,o.text]);let l=n.attr("href").substring(1);i.val(l),b(n.html())}).on("click",".js-webcito-reset",function(t){t.preventDefault(),i.val(null),c.val(null),s.empty(),b(),u(a.waitingForTypingText)}).on("hidden.bs.dropdown",".dropdown",function(){s.empty(),c.val(null),u(a.waitingForTypingText)}).on("shown.bs.dropdown",".dropdown",function(){c.focus()}),i.data("init",!0)),null!==g&&"val"===g.toLowerCase()&&(i.val(null),c.val(null),s.empty(),b(),u(a.waitingForTypingText),f(!1,n)),i}}(jQuery);